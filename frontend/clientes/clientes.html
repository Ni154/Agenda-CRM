<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clientes</title>

<link rel="stylesheet" href="../css/style.css">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="../js/supabase.js"></script>

<style>
body{font-family:Arial;background:#f4f4f4;padding:20px}

.card{
 background:white;
 padding:15px;
 margin:10px 0;
 border-radius:10px;
 box-shadow:0 5px 10px rgba(0,0,0,0.1);
 display:flex;
 justify-content:space-between;
 align-items:center;
}

input{
 width:100%;
 padding:10px;
 margin:5px 0;
 border-radius:5px;
 border:1px solid #ccc;
}

button{
 background:#C9A227;
 color:white;
 border:none;
 padding:10px;
 border-radius:5px;
 cursor:pointer;
 margin:5px 0;
}
</style>

</head>

<body>

<h2>Clientes</h2>

<input id="busca" placeholder="Buscar cliente..." oninput="filtrar()">

<button onclick="novo()">Novo Cliente</button>

<div id="lista"></div>

<script>

let clientes=[]

async function carregar(){
 const {data}=await supabase.from("clientes").select("*").order("nome")
 clientes=data || []
 render(clientes)
}

function render(dados){
 lista.innerHTML=dados.map(c=>`
 <div class="card">
  <div>
   <b>${c.nome}</b><br>
   ${c.telefone || ""}
  </div>
  <div>
   <button onclick="abrir('${c.id}')">Abrir</button>
  </div>
 </div>
 `).join("")
}

function filtrar(){
 const termo=busca.value.toLowerCase()
 const filtrado=clientes.filter(c=>c.nome.toLowerCase().includes(termo))
 render(filtrado)
}

function novo(){
 window.location.href="cliente-form.html"
}

function abrir(id){
 window.location.href=`cliente-detalhe.html?id=${id}`
}

carregar()

</script>

</body>
</html>
