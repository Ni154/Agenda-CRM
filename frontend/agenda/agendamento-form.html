<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Novo Agendamento</title>

<link rel="stylesheet" href="../css/style.css">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="../js/supabase.js"></script>

<style>
body{font-family:Arial;background:#f4f4f4;padding:20px}

.box{
 background:white;
 padding:20px;
 border-radius:10px;
 max-width:400px;
 margin:auto;
 box-shadow:0 5px 10px rgba(0,0,0,0.1);
}

input,select{
 width:100%;
 padding:10px;
 margin:5px 0;
 border-radius:5px;
 border:1px solid #ccc;
}

button{
 width:100%;
 background:#C9A227;
 color:white;
 border:none;
 padding:10px;
 border-radius:5px;
 cursor:pointer;
}
</style>

</head>

<body>

<div class="box">

<h2>Novo Agendamento</h2>

<label>Cliente</label>
<select id="cliente"></select>

<label>Servi√ßo</label>
<select id="servico"></select>

<label>Data e Hora</label>
<input type="datetime-local" id="data">

<button onclick="salvar()">Salvar</button>

</div>

<script>

async function carregar(){

 const {data:clientes}=await supabase.from("clientes").select("id,nome")
 cliente.innerHTML=clientes.map(c=>`<option value="${c.id}">${c.nome}</option>`)

 const {data:servicos}=await supabase.from("servicos").select("id,nome")
 servico.innerHTML=servicos.map(s=>`<option value="${s.id}">${s.nome}</option>`)
}

async function salvar(){

 await supabase.from("agendamentos").insert({
  cliente_id:cliente.value,
  servico_id:servico.value,
  data_hora:data.value,
  status:"agendado"
 })

 alert("Agendado!")
 window.location.href="agenda.html"
}

carregar()

</script>

</body>
</html>
